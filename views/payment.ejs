<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">
    <title>Payment</title>
</head>

<body class="bg-gray-50 pt-[90px]">

    <!-- NAVBAR -->
    <%- include("partials/header") %>

    <div class="max-w-6xl mx-auto px-6 py-10">

        <h2 class="text-3xl font-bold mb-6">Payment</h2>

        <div class="flex flex-col lg:flex-row gap-10">

            <!-- LEFT SIDE -->
            <div class="flex-1 space-y-10">

                <!-- DELIVERY ADDRESS -->
                <div class="bg-white p-6 rounded-xl shadow">
                    <h3 class="text-xl font-semibold mb-2 flex items-center gap-2">
                        <i class="ri-map-pin-line text-2xl"></i>
                        Delivery Address
                    </h3>

                    <% if (user.address) { %>
                    <p class="text-gray-700"><%= user.address %></p>

                    <% } else { %>
                    <p class="text-red-500 font-medium">No address added!</p>
                    <a href="/edit-address" class="text-blue-600 hover:underline">
                        Add Address
                    </a>
                    <% } %>
                </div>

                <!-- ORDER ITEMS PREVIEW -->
                <div class="bg-white p-6 rounded-xl shadow">
                    <h3 class="text-xl font-semibold mb-4">Items in Cart</h3>

                    <% user.cart.forEach(item => { %>
                    <div class="flex items-center gap-4 border-b py-3">
                        <img src="data:image/jpeg;base64,<%= item.product.image.toString('base64') %>"
                            class="h-16 w-16 object-contain rounded-lg">

                        <div>
                            <p class="font-semibold"><%= item.product.name %></p>
                            <p class="text-gray-600 text-sm">Qty: <%= item.quantity %></p>
                            <p class="font-semibold">₹ <%= item.product.price %></p>
                        </div>
                    </div>
                    <% }) %>
                </div>

            </div>

            <!-- RIGHT SIDE – ORDER SUMMARY -->
            <div class="w-full lg:w-[360px]">

                <div class="bg-white p-6 rounded-xl shadow sticky top-[100px]">

                    <h3 class="text-xl font-bold mb-4">Order Summary</h3>

                    <% let subtotal = 0;
                       user.cart.forEach(i => subtotal += i.product.price * i.quantity);
                    %>

                    <div class="text-lg font-medium flex justify-between">
                        <span>Subtotal</span>
                        <span>₹ <%= subtotal %></span>
                    </div>

                    <div class="text-lg font-medium flex justify-between mt-2">
                        <span>Platform Fee</span>
                        <span>₹ 20</span>
                    </div>

                    <div class="text-lg font-medium flex justify-between border-b pb-2 mt-2">
                        <span>Shipping Fee</span>
                        <span>₹ 0</span>
                    </div>

                    <div class="text-xl font-bold flex justify-between mt-2">
                        <span>Total</span>
                        <span>₹ <%= subtotal + 20 %></span>
                    </div>

                    <!-- FAKE PAYMENT BUTTON -->
                    <a href="/fake-payment"
                        class="block bg-black text-white text-center py-3 rounded-lg mt-6 font-semibold hover:bg-gray-800">
                        Proceed to Pay
                    </a>

                </div>

            </div>

        </div>
    </div>

</body>

</html>
